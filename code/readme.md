code built base on tensorflow v1.8 (which is out-of-date)